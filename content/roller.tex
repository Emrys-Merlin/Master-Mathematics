\section{Pocsets and the Roller compactification}
\label{sec:roller}

\subsection{Pocsets and Ultrafilters}
\label{sec:pocset}

\begin{defin}[Pocset, {\cite{Roller1999}}]
  \begin{itemize}
  \item A \emph{pocset} is a triple \((P, \prec, \ast)\) consisting of a set \(P\) a partial ordering \(\prec\) on \(P\) and a fixed point free, order reversing involution \(\ast\) on \(P\). If no confusion can arise, we will often drop the triple and will only write \(P\) when talking about the pocset. \(f \colon P \to P'\), where \(P\) and \(P'\) are pocsets, is called a \emph{pocset morphism}, if for all \(A, B \in P\) such that \(A \prec B\) implies that \(f(A) \prec f(B)\) and \(f(A^\ast) = f(A)^\ast\) holds. 
  \item A pocset \(P\) is called \emph{discrete}, if for any two \(A, B \in P\) the \emph{interval}
    \[
      [A,B] = \{C \in P \mid A \prec C \prec B\}
    \]
    is finite.
  \item Two elements \(A,B\) of a pocset \(P\) are called \emph{nested}, if they satisfy \(A \prec B\), \(A^\ast \prec B\), \(A \prec B^\ast\) or \(A^\ast \prec B^\ast\). Otherwise they are called \emph{transverse}.
  \item A pocset \(P\) is called \emph{finite width}, if there exists a constant \(N \in \N\) such that the cardinality of any subset of transverse elements of \(P\) is bounded from above by \(N\).
  \end{itemize}
\end{defin}

\begin{rem}
  \label{rem:roller}
  In his habilitation \textcite{Roller1999} showed that there is a one to one correspondence between discrete pocsets and CAT(0) cube complexes. The direction from the complexes \(X\) to the pocsets is easy to realize, one takes the pocset of halfspaces \(\mathcal{H}(X)\) (which is discrete by Lemma~\ref{lem:finite-interval}). The other way around is far more involved and makes heavy use of so called \emph{ultrafilters} as defined below. This Roller construction is what lead to the Roller compactification of every finite-dimensional CAT(0) cube complex.

  One important observation is, that every CAT(0) cube complex is already uniquely defined by its pocset of halfspaces, which leads to the following observation.
\end{rem}

\begin{prop}[{\cite[Lemma~2.5]{Caprace2010}}]
  A CAT(0) cube complex \(X\) splits as a (proper) product if and only if  there  exists a partition \(\mathcal{H}(X) = \mathcal{H}_1 \sqcup \mathcal{H}_2\), such that each halfspace in \(\mathcal{H}_1\) is transverse to each halfspace in \(\mathcal{H}_2\).
\end{prop}

\begin{proof}[Sketch of proof]
  The key observation is, that if we have two CAT(0) cube complexes \(X_1\) and \(X_2\) and we consider the cube complex \(X_1 \times X_2\), then the halfspaces take the form \(\mathfrak{h} \times X_2\) for any \(\mathfrak{h} \in \mathcal{H}(X_1)\) or \(X_1 \times \mathfrak{k}\) for any \(\mathfrak{k} \in \mathcal{H}(X_2)\). And two of this different types of halfspaces will always be transverse. Thus if \(X\) splits as a product, then this argument shows, that we find the desired partition. If we have the partition, then the \(\mathcal{H}_i\) are easily to be seen pocsets. Hence, up to isomorphism, we find two unique CAT(0) cube complexes corresponding to the two pocsets and their product has the same set of halfspaces as \(X\). By the aforementioned uniqueness they have to be isomorphic.
\end{proof}

The above proposition leads to the following definition:

\begin{defin}
  A CAT(0) cube complex \(X\) is called \emph{reducible}, if it can be decomposed as a (proper) product of CAT(0) cube complexes. Otherwise, it is called \emph{irreducible}.
\end{defin}

\begin{prop}[{\cite[Proposition~2.6]{Caprace2010}}]
  \label{prop:cs-2.6}
  A finite-dimensional CAT(0) cube complex \(X\) admits an (up to permutation) canonical decomposition
  \[
    X = X_1 \times \dots \times X_m
  \]
  into a product of irreducible cube complexes \(X_i\). Every automorphism of \(X\) preserves that decomposition, up to a permutation of possibly isomorphic factors. In particular, the image of the canonical embedding
  \[
    \Aut(X_1) \times \dots \times \Aut(X_m) \hookrightarrow \Aut(X)
  \]
  has finite index in \(\Aut(X)\).
\end{prop}

\begin{defin}[Ultrafilter]
  Let \((A, \prec, \ ^\ast)\) be a pocset. Let \(\tilde A\) be the set of equivalence classes via: \(a \sim b\) if and only if \(a^\ast = b\) or \(a = b\). This is in fact an equivalence relation. We define
  \[
    P(A) \coloneqq \prod_{\tilde a \in \tilde A} \tilde a,
  \]
  i.\,e.\ \(P(A)\) is the product over all the two element sets containing an element of \(A\) and its opposite under involution. Let \(\alpha \in P(A)\). We will use the notation \enquote{\(a \in \alpha\)} for some \(a \in A\) to mean that the natural projection \(P(A) \to \tilde a\) maps \(\alpha\) to \(a\) (instead of to \(a^\ast\)). With this notation introduced, we define:
  
  An element \(\alpha \in P(A)\) is called an \emph{ultrafilter}, if it satisfies the so called \emph{consistency condition}, namely: If \(a \in \alpha\) and \(b \in A\) such that \(a \subset b\) then \(b \in \alpha\).

  We denote by \(\mathcal{U}(A) \subset P(A)\) the subset of all ultrafilters. The set \(P(A)\) can be topologized using the product topology, if the two element sets \(\tilde a\) to be topologized by the discrete topology. With this (using Tychonoff's theorem, see e.\,g.~\cite[Chapter~10]{MR1275831}) the set \(P(A)\) becomes a compact topological space. A basis of the topology is given by the sets of the form
\[
  \mathcal{U}(a_1,\dots, a_n) \coloneqq \{\alpha \in P(A) \mid a_1, \dots, a_n \in \alpha\},
\]
where \(a_1,\dots, a_n \in A\) are arbitrary elements.
\end{defin}

\begin{bsp}
  We will have a look at ultrafilters at the example of a tree. In this case each edge defines a unique hyperplane and hence the choice of a halfspace is equivalent to assigning a direction to an edge. We will adopt the notation that the arrow, we assign to an edge will point towards the chosen halfspace. Since each ultrafilter contains either a halfspace or its complement, we have to assign an arrow to each edge. The consistencey condition implies that if we have an outgoing edge at a vertex, then all other edges must be incoming. In other words, an ultrafilter converts our undirected tree into a directed one such that each vertex has at most one outgoing edge. An example of this can be found in Figure~\ref{fig:ultrafilter}
  \begin{figure}[htbp]
    \centering
    \input{./images/tree.tex}
    \caption{A tree with inscribed ultrafilter}
    \label{fig:ultrafilter}
  \end{figure}

  This reformulation leads to another interesting observation. If all vertices have one outgoing edge, then we can start a geodesic ray from any vertex following the ultrafilter. Each of these geodesic rays will merge after finitely many steps and emanate on. Hence, each of these ultrafilters defines one element at the visual boundary of the tree. Additionally, one can convince oneself that the only other possibility is, that there is exactly one vertex with no outgoing edge (c.\,f.~\cite[14]{sageev-lecture-notes}). Hence, these ultrafilters define a unique vertex in the tree.

  In this sense we see that in the case of trees ultrafilters are a reformulation of the visual compactification of the CAT(0) space. 
\end{bsp}

% \begin{defin}
%   Let \(\alpha\) be an ultrafilter and \(\mathfrak{h}_1, \dots, \mathfrak{h}_n \in \alpha\). Then \(\alpha; \mathfrak{h}_1, \dots, \mathfrak{h}_n \in P(A)\) is defined by replacing each \(\mathfrak{h}_i\) in \(\alpha\) by \(\mathfrak{h_i}^\ast\).
% \end{defin}

% \begin{lemma}
%   Let \(\alpha\) be an ultrafilter and \(\mathfrak{h} \in \alpha\). Then \((\alpha;\mathfrak{h})\) is an ultrafilter if and only if \(\mathfrak{h}\) is minimal, i.\,e.\ if \(\mathfrak{h}' \in \alpha\) satisfies \(\mathfrak{h'} \subset \mathfrak{h}\) then \(\mathfrak{h'} = \mathfrak{h}\) holds.
% \end{lemma}

% \begin{proof}
%   First, consider the case that \(\beta \coloneqq (\alpha, \mathfrak{h})\) is an ultrafilter. Let \(\mathfrak{h}' \in \alpha\) such that \(\mathfrak{h}' \subset \mathfrak{h}\). Equivalently this means \(\mathfrak{h}^\ast \subset \mathfrak{h}'^\ast\). Since \(\beta\) is an ultrafilter, it follows that \(\mathfrak{h}'^\ast \in \beta\). However, this is only possible if \(\mathfrak{h} = \mathfrak{h}'\), since otherwise \(\beta\) would have to contain both \(\mathfrak{h}' \) and \(\mathfrak{h}'^\ast\).

%   Now, consider that \(\mathfrak{h} \in \alpha\) is minimal. Let \(\mathfrak{h}' \in \beta\) and \(\mathfrak{\tilde h}\) be any halfspace with \(\mathfrak{h}' \subset \mathfrak{\tilde h}\). If \(\mathfrak{h}' \neq \mathfrak{h}\) then \(\mathfrak{h}' \in \alpha \) and hence \(\mathfrak{\tilde h} \in \alpha\). Additionally, \(\mathfrak{\tilde h} \neq \mathfrak{h}\) and it follows that \(\mathfrak{\tilde h} \in \beta\). If \(\mathfrak{h}' = \mathfrak{h}\) then it follows that \(\mathfrak{\tilde h}^\ast \subset \mathfrak{h}\) and thus we have equality. Showing again that \(\mathfrak{\tilde h} = \mathfrak{h}^\ast \in \beta\).
% \end{proof}

\subsection{The Roller compactification}
\label{sec:rb}

% For now, we denote by \(\mathcal{U}(X)\) the set of all ultrafilters of the pocset of halfspaces of \(X\). Next, consider \(\alpha, \beta \in \mathcal{U}(X)\) and define \(d(\alpha, \beta) \coloneqq \# \{ \mathfrak{h} \in \mathcal{H}(X)\mid \mathfrak{h} \in \alpha \wedge \mathfrak{h}^\ast \in \beta\}\). This is not a distance in the ordinary sense on \(\mathcal{U}(X)\) because it might take \(+\infty\) as a value. However, with its help we can define a graph \(G\) with the ultrafilters as its vertices and edges between \(\alpha\) and \(\beta\), whenever \(d(\alpha, \beta) = 1\).\todo{what do I want with this?}

% \begin{defin}
%   For any \(x \in X\), we define \(\alpha_x \in \mathcal{U}(X)\) by always choosing the halfspace containing \(x\). It follows readily from the definition that this is an ultrafilter. An ultrafilter that arises in this manner is called a \emph{principal ultrafilter}
% \end{defin}

\begin{prop}
  Let \(A\) be a pocset then the set of all ultrafilters \(\mathcal{U}(A)\) is a compact space.
\end{prop}

\begin{proof}
  Since \(P(A)\) is already compact it suffices to show, that \(\mathcal{U}(A)\) is closed in \(P(A)\). However, the complement
  \begin{align*}
    P(A) \setminus \mathcal{U}(A)
    & = \{\alpha \in P(A) \mid \exists a, b \in A\colon a \in \alpha,\ b \notin \alpha,\ a \subset b\}\\
    & = \bigcup_{a \in A} \{\alpha \in P(A) \mid a \in \alpha,\ \exists b \in A\colon a \subset b,\ b \notin \alpha\}\\
    & = \bigcup_{a \in A} \{\alpha \in P(A) \mid a \in \alpha,\ \exists b \in A\colon a \subset b,\ b^\ast \in \alpha\}\\
    & = \bigcup_{a \in A} \bigcup_{a \subset b}\{\alpha \in P(A) \mid a \in \alpha,\ b^\ast \in \alpha\}\\
    & = \bigcup_{a \in A} \bigcup_{a \subset b}\mathcal{U}(a, b^\ast)
  \end{align*}
  is open, which proves the claim.
\end{proof}

\begin{cor}
  \label{cor:comp-met}
  If \(A\) is countable then \(\mathcal{U}(A)\) is a compact metrizable space. In particular, if \(X\) is a locally countable CAT(0) cube complex and \(\mathcal{H}\) is its pocset of halfspaces then \(\mathcal{U}(\mathcal{H})\) is a compact metrizable space.
\end{cor}

\begin{proof}
  By~\textcite[Thm.\ 4.2.2]{Engelking} it holds that every countable product of metrizable spaces leads to a metrizable space. Thus \(P(A)\) is a compact metrizable space. Since \(\mathcal{U}(A)\) is a closed subset the same is true for this space.

  If \(X\) is locally countable, then the pocset \(\mathcal{H}\) is countable by Corollary~\ref{cor:halfspace-countable}.
\end{proof}

\begin{defin}
  An ultrafilter \(\alpha\) satisfies the \emph{descending chain condition}, if all descending chains in \(\alpha\) become stationary.

  An ultrafilter is called \emph{non-terminating}, if every finite descending chain can be extended.
\end{defin}

\begin{thm}
  \label{thm:roller-compactification}
  Let \(X\) be a finite-dimensional CAT(0) cube complex and \(V(X)\) its vertex set with associated pocset \((\mathcal{H}, \subset, ^\ast)\).
  \begin{enumerate}
  \item For every vertex \(v \in V(X)\) we have that
    \[
      \alpha_v \coloneqq \{\mathfrak{h} \in \mathcal{H}(X) \mid v \in \mathfrak{h}\}
    \]
    is an ultrafilter. Furthermore, it satisfies the descending chain condition and any ultrafilter satisfying the descending chain condition arises in this way.
  \item The map \(V(X) \to \mathcal{U}(X) \coloneqq \mathcal{U}(\mathcal{H}),\ v \mapsto \alpha_v\) is injective, continuous and the image is dense in \(\mathcal{U}(X)\). 
  % \item If \(X\) is locally finite, then the image of \(V(X)\) is open in \(\mathcal{U}(X)\).
  \end{enumerate}
\end{thm}

\begin{proof}
  \begin{enumerate}
  \item Clearly, exactly \(\mathfrak{h}\) or \(\mathfrak{h}^\ast\) must contain \(v\) such that \(\alpha_v\) satisfies the choice condition. Furthermore, if \(\mathfrak{h} \in \alpha_v\) and \(\mathfrak{k} \in \mathcal{H}\) such that \(\mathfrak{h} \subset \mathfrak{k}\), we have \(v \in \mathfrak{h} \subset \mathfrak{k}\) and hence \(\mathfrak{k} \in \alpha_v\) showing that \(\alpha_v\) satisfies the consistency condition. All in all this shows that \(\alpha_v\) is an ultrafilter.

    If \(\alpha\) satisfies the descending chain condition, then each halfspace contains a minimal halfspace of \(\alpha\). If we take the set of minimal halfspaces of \(\alpha\), then all the elements must be pairwise transverse. Furthermore, since \(X\) is finite-dimensional every set of pairwise transverse elements must be finite (indeed smaller than \(\dim X\)). By Theorem~\ref{thm:common-intersection}, we find that the intersection over all minimal elements is non-empty and contains a vertex \(v\). We claim that \(\alpha_v = \alpha\). Indeed, if \(\mathfrak{h} \in \alpha\), then there exists a minimal element \(\mathfrak{k} \in \alpha\) and \(v \in \mathfrak{k}\) hence also in \(\mathfrak{h}\) and \(\mathfrak{h} \in \alpha_v\). Conversely, if \(\mathfrak{h} \not \in \alpha\) then \(\mathfrak{h}^\ast \in \alpha\) and as before \(v \in \mathfrak{h}^\ast\) and \(\mathfrak{h} \not \in \alpha_v\).
  \item In order to see the injectivity consider two vertices \(v \neq w\). Then there exists a halfspace \(\mathfrak{h}\) separating the two, i.\,e.\ \(v \in \mathfrak{h}\) and \(w \in \mathfrak{h}^\ast\). Hence, \(\mathfrak{h} \in \alpha_v\) and \(\mathfrak{h}^\ast \in \alpha_w\) and \(\alpha_v \neq \alpha_w\). The continuity is clear, since we have the discrete topology on \(V(X)\). Lastly, we have to show that the image is dense. We consider a basic open set \(\mathcal{U} \coloneqq \mathcal{U}(\mathfrak{h}_1, \dots, \mathfrak{h}_n)\) in \(\mathcal{U}(X)\). Without loss of generality we can assume that the \(\mathfrak{h}_i\) are pairwise transverse. If they were contained in each other, we could remove redundant elements and if we have a pair of halfspaces which is identified under involution, then the set were empty. However, in this case we know again by Theorem~\ref{thm:common-intersection} that \(\bigcap_{i=1}^n \mathfrak{h}_i\) contains a vertex \(v\) and hence \(\alpha_v \in \mathcal{U}\).
  % \item We will show that each \(\alpha_v\) contains an open neighborhood that is completely contained in the image of our map. Indeed, we will see that \(\{\alpha_v\}\) is open in \(\mathcal{U}(X)\). Since \(X\) is locally finite, \(v\) is contained in finitely many cubes. In particular it is contained in only finitely many edges. Let \(\mathfrak{h}_1, \dots, \mathfrak{h}_n\) bet the set of halfspaces containing \(v\) defined by those edges. We claim that \(\mathcal{U} \coloneqq \mathcal{U}(\mathfrak{h}_1, \dots, \mathfrak{h}_n) = \{\alpha_v\}\). Let \(\alpha \in \mathcal{U}\). Assume there exists \(\mathfrak{h} \in \alpha\) such that \(v \not \in \mathfrak{h}\). Take \(\tilde w \in \mathfrak{h}\) and choose a shortest edge path between \(v\) and \(\tilde w\). At some point this path will have to cross \(\mathfrak{\hat h}\) and we choose \(w\) as the first vertex on the path in \(\mathfrak{h}\). Then the shrunk segment between \(v\) and \(w\) is still a shortest path. Furthermore, the path must cross one of the \(\mathfrak{\hat h}_i\). After a possible relabeling, let \(\mathfrak{h}_1, \dots, \mathfrak{h}_k\) be the subset of halfspaces that separates \(v\) from \(w\). Then for \(k+1 \leq i \leq n\) we have \(w \in \mathfrak{h}_i \cap \mathfrak{h}\). Assume that all the \(\mathfrak{h}_i\) for \(i \leq k\) were transverse to \(\mathfrak{h}\). Then again with the help of Theorem~\ref{thm:common-intersection} we would have that \(\bigcap_{i=1}^n \mathfrak{h}_i \cap \mathfrak{h}\) is not empty. However, \(\bigcap_{i=1}^n \mathfrak{h}_i = \{v\}\). This is a contradiction to the fact that \(v \not\in \mathfrak{h}\). Hence, we must have that at least one \(\mathfrak{h}_i\) is nested with \(\mathfrak{h}\). However, the only possibility is \(\mathfrak{h}_i \subset \mathfrak{h}^\ast\).\todo{not so easy, rewrite} Since \(\alpha \in \mathcal{U}\), we have \(\mathfrak{h}_i \in \alpha\) and by consistence also \(\mathfrak{h}^\ast \in \alpha\), which is a contradiction. Hence, \(\alpha_v\) is the only ultrafilter in \(\mathcal{U}\).
  \end{enumerate}
\end{proof}

\begin{rem}
  It is often assumed that a space is an open subset of its compactification. In our case this can fail, as can be seen from the following example: We consider an infinite family of copies of the non-negative reals \(\R_{\geq0}\) with their standard cubulation. We glue these lines together at their respective origins (and call this vertex \(\ast\)). This construction leads to a tree and hence to a CAT(0) cube complex. We claim that any open neighborhood of the ultrafilter \(\alpha_\ast\) contains an ultrafilter which does not satisfy the descending chain condition. The construction is depicted in Figure~\ref{fig:roller-counterexample}
  \begin{figure}[htbp]
    \centering
    \input{./images/roller-counterexample.tex}
    \caption{The left-hand side depicts the ultrafilter \(\alpha_\ast\). The blue edges depict the halfspaces, determined by \(\mathcal{U}(\mathfrak{h}_1, \dots, \mathfrak{h}_n)\). The green branch is a branch containing no \(\mathfrak{h}_i\) and whose halfspaces can therefore be reversed. This leads to the ultrafilter \(\alpha\) on the right-hand side.}
    \label{fig:roller-counterexample}
  \end{figure}

  Let \(\mathcal{U} \coloneqq \mathcal{U}(\mathfrak{h}_1, \dots, \mathfrak{h}_n)\) be any basic open set containing \(\alpha_\ast\). Then \(\mathfrak{h}_i \in \alpha_\ast\). We recall from Example~\ref{bsp:ccc} that in the case of trees, halfspaces correspond to the choice of a direction at an edge and in the case of \(\alpha_\ast\) all arrows have to point towards \(\ast\). Since we have infinitely many branches with \(\ast\) as their root, but only finitely many arrows prescribed by the \(\mathfrak{h}_i\), we can construct the follwing ultrafilter: We take \(\alpha_\ast\) and choose a branch which does not contain one of the edges with prescribed direction (the green branch in the figure). On this branch we reverse all arrows. This leads to a new ultrafilter \(\alpha\) (each vertex has at most one outgoing edge), which does not satisfy the descending chain condition, but nonetheless lies in \(\mathcal{U}\).
\end{rem}

Now that we have defined the Roller compactificatoin, we have to consider a second equivalent construction. The advantage of the above construction was, that the topological and metric properties were easy to establish. However, the disadvantage of the construction is that the ultrafilters are not simply sets or more precisely special subsets of \(\mathcal{H}(X)\), but elements in a product space. This form has its advantages when it comes to talking about measurability of certain maps. Therefore, we will establish this second viewpoint as well and prove the equivalence of the two.

\begin{defin}
  \label{def:pot-top}
  Let \(A\) be a set. Let \(F_1, F_2 \subset A\) be finite. Then
  \begin{align*}
    C(F_1, F_2) & \coloneqq \{ H \subset A \mid F_1 \subset H \text{ and } F_2 \subset A \setminus H\} \subset \operatorname{Pot}(A)
  \end{align*}
  is called a \emph{cylinder set}. We set \(\mathcal{C}(a) \coloneqq C(\{a\}, \varnothing)\) for arbitrary \(a \in A\).
\end{defin}

\begin{prop}
  \label{prop:pot-top}
  The set of all cylinder sets is a basis for a topology on \(\operatorname{Pot}(A)\) for any set \(A\).
\end{prop}

\begin{proof}
  There are two properties we have to establish
  \begin{enumerate}
  \item We have to show that the union of all cylinder sets is all of the power set. So let \(H \subset A\). If \(H = \varnothing\), we can take \(F_1 = \varnothing\) and \(F_2 = A\). If \(H = A\) we interchange \(F_1\) and \(F_2\). In all other cases, there must exist \(x,y \in A\) such that \(x \in H\) and \(y \in A \setminus H\) and thus \(A \in C(\{x\}, \{y\})\).
  \item We have to show that each intersection of two cylinder sets can be represented by a union of arbitrarily many cylinder sets. Thus let \(F_1, F_2, G_1, G_2 \subset A\) be finite and consider
  \begin{align*}
    C(F_1, F_2) \cap C(G_1, G_2)
    & = \{H \subset A \mid F_1 \cap G_1 \subset H \text{ and } F_2 \cap G_2 \subset A \setminus H\}\\
    & = C(F_1 \cap G_1, F_2 \cap G_2).
  \end{align*}
  Since \(F_1 \cap G_2\) and \(F_2 \cap G_2\) are still finite we are done.
  \end{enumerate}
\end{proof}

\begin{defin}
  We say that a subset \(\alpha \subset \mathcal{H} \coloneqq \mathcal{H}(X)\) satisfies:
  \begin{enumerate}
  \item the \emph{partial choice} condition, if \(\alpha \cap \alpha^\ast = \varnothing\),
  \item the \emph{choice} condition, if \(\alpha \cap \alpha^\ast = \varnothing\) and \(\alpha \sqcup \alpha^\ast = \mathcal{H}\) and
  \item the \emph{consistency} condition, if whenever \(\mathfrak{h} \in \alpha\) and \(\mathfrak{k} \in \mathcal{H}\) such that \(\mathfrak{h} \subset \mathfrak{k}\) then \(\mathfrak{k} \in \alpha\).
  \end{enumerate}
  If \(\alpha\) satisfies the choice and the consistency condition it is called a \emph{(set-)ultrafilter}. We denote by \(\mathcal{U}_s(X) \subset \operatorname{Pot}(\mathcal{H}(X))\) the set of all (set-)ultrafilters and equip it with the subspace topology inherited from the power set.
\end{defin}

\begin{lemma}
  \(\mathcal{U}_s(X)\) is a Hausdorff space.
\end{lemma}

\begin{proof}
  Let \(\alpha, \beta \in \mathcal{U}_s(X)\) and \(\alpha \neq \beta\). Then there exists \(\mathfrak{h} \in \alpha\) such that \(\mathfrak{h}^\ast \in \beta\) (This follows from the first property of (set-)ultrafilters). Next, let us define
  \begin{align*}
    U & \coloneqq \mathcal{C}(\mathfrak{h}) \cap \mathcal{U}_s(X)\quad \text{and}\\
    V & \coloneqq \mathcal{C}(\mathfrak{h}^\ast) \cap \mathcal{U}_s(X).
  \end{align*}
  By construction both sets are open and we have \(\alpha \in U\) and \(\beta \in V\). Furthermore, no (set-)ultrafilter can contain both \(\mathfrak{h}\) and \(\mathfrak{h}^\ast\). Thus \(U \cap V = \varnothing\). 
\end{proof}

\begin{thm}
  \(\mathcal{U}(X)\) and \(\mathcal{U}_s(X)\) are homeomorphic.
\end{thm}

\begin{proof}
  Consider the map
  \begin{align*}
    f\colon &\mathcal{U}(X) \to \mathcal{U}_s(X),\\
    &(\mathfrak{h}_i)_{i \in \mathcal{\hat H}(X)} \mapsto \{\mathfrak{h}_i \mid i \in \mathcal{\hat H}(X)\}.
  \end{align*}
  This map is well-defined and bijective. Next, let us show that it is continuous.

  Let \(\mathfrak{h}_1, \dots, \mathfrak{h}_n, \mathfrak{h'}_1, \dots,\mathfrak{h'}_k \in \mathcal{H}(X)\) and set
  \[
    U \coloneqq C(\{\mathfrak{h}_1, \dots, \mathfrak{h}_n\}, \{\mathfrak{h'}_1, \dots, \mathfrak{h'}_k\}) \cap \mathcal{U}_s(X).
  \]
  Without loss of generality we can assume that \(\mathfrak{h}^\ast_i \neq \mathfrak{h'}_j\) for all possible \(i\) and \(j\). Otherwise \(U\) would be empty. Thus we have
  \begin{align*}
    f^{-1}(U)
    & = \{\alpha \in \mathcal{U}(X) \mid \mathfrak{h}_i \in \alpha \text{ and } \mathfrak{h'}_j \notin \alpha\}\\
    & = \{\alpha \in \mathcal{U}(X) \mid \mathfrak{h}_i, \mathfrak{h'}^\ast_j \in \alpha\}\\
    & = \mathcal{U}(\mathfrak{h}_1, \dots, \mathfrak{h}_n, \mathfrak{h'}^\ast_1, \dots, \mathfrak{h'}^\ast_k),
  \end{align*}
  which is a basic open set in \(\mathcal{U}(X)\). However, this already suffices to show that \(f\) is an homeomorphism. Indeed, every closed set \(A \subset \mathcal{U}(X)\) is compact (since \(\mathcal{U}(X)\) is) and as \(f\) is continuous \(f(A)\) is also compact. Lastly, we have established that \(\mathcal{U}_s(X)\) is Hausdorff and hence \(f(A)\) is also closed. This finishes the proof.
\end{proof}

With the above theorem in place, we can switch viewpoints whenever necessary. Actually, whenever convenient we will \enquote{confuse} the two and stop to distinguish between ultrafilters and set-ultrafilters. Furthermore, with Theorem~\ref{thm:roller-compactification} in place, we can think of \(\mathcal{U}(X)\) as a compactification of the vertex set of \(X\) and we will write \(\bar X \coloneqq \mathcal{U}(X)\) for the set of ultrafilters on \(X\) and \(\partial X\) for the set of all ultrafilters which have at least one infinite descending chain (by abuse of notation one often writes \(\partial X \coloneqq \bar X \setminus X\)).

\begin{defin}
  Let \(\alpha,\beta \in \bar X\). Then the \emph{interval \([\alpha,\beta]\)} is defined via
  \[
    [\alpha,\beta] \coloneqq \bigcap_{\mathfrak{h} \in \alpha \cap \beta} \mathfrak{h} \subset X
  \]
\end{defin}

\begin{lemma}
  \label{lem:x-interval}
  Let \(X\) be a CAT(0) cube complex and \(\alpha \in \bar X\) an ultrafilter. If \(\alpha^\ast\) is an ultrafilter then \(\bar X = [\alpha, \alpha^\ast]\).
\end{lemma}

\begin{proof}
  Since no halfspace can be contained in both \(\alpha\) and \(\alpha^\ast\) we have an empty intersection and thus the equality \(\bar X = [\alpha, \alpha^\ast]\) holds.
\end{proof}

\begin{thm}[{\cite[Theorem 1.14]{Brodzki2009}}]
  \label{thm:interval}
  Let \(X\) be a finite dimensional CAT(0) cube complex and \([x,y] \subset \bar X\) an interval. Then \([x,y]\) is isometrically embeddable in \(\R^d\) considered as a CAT(0) cube complex equipped with the \(l_1\)-metric.
\end{thm}

\begin{defin}
  \label{defin:separating}
  Let \(\alpha\) and \(\beta\) be two ultrafilters. Then
  \[
    \mathcal{H}(\alpha,\beta) \coloneqq \{\mathfrak{h} \in \mathcal{H} \mid \mathfrak{h} \in \alpha \text{ and } \mathfrak{h}^\ast \in \beta\}
  \]
  is the set of separating halfspaces of \(\alpha\) and \(\beta\).
\end{defin}

\begin{rem}
  \label{rem:interval}
  Indeed we have that \(\mathcal{H}(x,y) = \mathcal{H}([x,y])\), i.\,e.\ the halfspaces separating \(x\) and \(y\) are exactly the halfspaces of the interval \([x,y]\). Together with the embedding into an \(\R^d\) by Theorem~\ref{thm:interval}, we yield that the number of terminal elements in \(\mathcal{H}(x,y)\) must always be finite.
\end{rem}

\begin{defin}
  \label{defin:tau}
  Let \(\mathcal{H}\) be the pocset of halfspaces of a CAT(0) cube complex and \(\mathcal{H}' \subset \mathcal{H}\) a subset. An element \(\mathfrak{h} \in \mathcal{H}'\) is called
  \begin{itemize}
  \item \emph{minimal in \(\mathcal{H}'\)} if for very \(\mathfrak{k} \in \mathcal{H'}\) we have either \(\mathfrak{k} \pitchfork \mathfrak{h},\ \mathfrak{h} \subset \mathfrak{k}\) or \(\mathfrak{h} \subset \mathfrak{k}^\ast\),
  \item \emph{maximal in \(\mathcal{H}'\)} if \(\mathfrak{h}^\ast\) is minimal in \(\mathcal{H}'\) or
  \item \emph{terminal in \(\mathcal{H}'\)} if it is either minimal or maximal in \(\mathcal{H}'\).
  \end{itemize}
  Let \(\tau\colon \operatorname{Pot}(\mathcal{H}) \to \operatorname{Pot}(\mathcal{H})\) be the map that assigns to each subset of \(\mathcal{H}\) its set of terminal elements.
\end{defin}

\begin{bsp}
  \label{bsp:finite-terminal}
  \begin{description}
  \item[DCC ultrafilters:] Every ultrafilter satisfying the descending chain condition contains minimal and hence terminal elements. If the CAT(0) cube complex is finite-dimensional, there can be at most finitely many transverse halfspaces and hence only finitely many minimal elements. In general, we cannot say anything about maximal elements in ultrafilters. 
  \item[Euclidean space:] In \(\R^d\) with its standard cubulation, we know that all halfspaces are parallel to coordinate axes and along each axis we can have at most one minimal and one maximal elment. This implies that any subset of halfspaces of \(\R^d\) can have at most \(2d\) terminal elements. With the help of Theorem~\ref{thm:interval} this reasoning can be extended to intervals, since they are embeddable into some \(\R^d\).
  \end{description}
\end{bsp}

\begin{lemma}[{\cite[Lemma~4.12]{MR3509968}}]
  \label{lem:4.12}
  Let \(\alpha\) and \(\beta\) be two ultrafilters and \(\mathfrak{h} \in \tau(\alpha)\). Then \(\mathfrak{h} \notin \beta\) if and only if \(\mathfrak{h} \in \tau(\mathcal{H}(\alpha,\beta))\).
\end{lemma}

\begin{proof}
  If \(\mathfrak{h} \in \beta\), then \(\mathfrak{h}\) does not separate \(\alpha\) and \(\beta\) hence \(\mathfrak{h} \notin \mathcal{H}(\alpha, \beta)\) and in the end also \(\mathfrak{h} \notin \tau(\mathcal{H}(\alpha, \beta))\). Conversely, assume \(\mathfrak{h} \notin \tau(\mathcal{H}(\alpha, \beta))\). If \(\mathfrak{h} \notin \mathcal{H}(\alpha, \beta)\) then \(\mathfrak{h} \in \beta\). Otherwise \(\mathfrak{h}\) were not a terminal element in \(\mathcal{H}(\alpha, \beta)\). However, this is impossible since \(\mathfrak{h}\) is terminal in \(\alpha\).
\end{proof}

\subsection{Embeddings of Roller compactification}
\label{sec:embedding-roller}

In this section we are interested in the question when the CAT(0) cube complex \(X'\) associated to a involution invariant subset \(\mathcal{H}' \subset \mathcal{H}(X)\) is embeddable in \(X\). This is not always possible, however, there are sufficient conditions for \(\mathcal{H}'\) to ensure the existence of an embedding \(\bar X' \hookrightarrow \bar X\).

\begin{defin}
  Let \(\mathcal{H}' \subset \mathcal{H} \coloneqq \mathcal{H}(X)\) be an involution invariant subset of halfspaces. A \emph{lifting decomposition} of \(\mathcal{H}'\) is a choice of a subset \(W \subset \mathcal{H} \setminus \mathcal{H}'\) satisfying the partial choice and consistency condition and so that \(\mathcal{H} = \mathcal{H}' \sqcup W \sqcup W^\ast\).
\end{defin}

\begin{lemma}[{\cite[Lemma~2.6]{MR3509968}}]
  \label{lem:lifting}
  Let \(\mathcal{H}' \subset \mathcal{H} \coloneqq \mathcal{H}(X)\) be an involution invariant subset of halfspaces. Assume that \(\mathcal{H}'\) admits a lifting decomposition \(\mathcal{H} = \mathcal{H}' \sqcup W \sqcup W^\ast\). Then there is a continuous injective map
  \begin{align*}
    i\colon \bar X' \coloneqq X(\mathcal{H}') & \to \bar X,\\
            \alpha & \mapsto \alpha \sqcup W,
  \end{align*}
  whose image is given by \(i(\bar X') = \cap_{\mathfrak{h} \in W} \mathcal{C}(\mathfrak{h})\) (c.\,f.\ Definition~\ref{def:pot-top}).

  If \(\mathcal{H}' = \varnothing\), then \(i(\bar X')\) is a point.

  If \(W\) contains an infinite descending chain then \(i(\bar X') \subset \partial X\).
\end{lemma}

\begin{proof}
  As can be seen from the formulation of the lemma, it is easier to work in with the power set definition of the Roller compactification in this setting.

  Since \(\mathcal{H}'\) is involution invariant, it is a pocset in its own right and therefore we can construct a unique CAT(0) cube complex \(X'\) with \(\mathcal{H}'\) as its set of halfspaces (c.\,f.\ Remark~\ref{rem:roller}). First, we need to show that the above construction of the map is well-defined. Let \(\alpha' \in \bar X'\). We claim that \(\alpha \coloneqq \alpha' \sqcup W\) is an ultrafilter in \(\bar X\). First, we see that\(\alpha\) satisfies the choice condition. Indeed,
  \begin{align*}
    \alpha \cap \alpha^\ast
    & = (\alpha' \sqcup W) \cap (\alpha^\ast \sqcup W^\ast)\\
    & = (\alpha' \cap \alpha'^\ast) \sqcup (\alpha' \cap W^\ast) \sqcup (W \cap \alpha'^\ast) \sqcup (W \cap W^\ast)\\
    & = \varnothing
  \end{align*}
  and
  \begin{align*}
    \alpha \sqcup \alpha^\ast
    & = (\alpha' \sqcup \alpha'^\ast) \sqcup W \sqcup W^\ast\\
    & = \mathcal{H}' \sqcup W \sqcup W^\ast\\
    & = \mathcal{H}.
  \end{align*}
  For the consistency condition, we have to check a couple of cases. Let \(\mathfrak{h} \in \alpha\) and \(\mathfrak{k} \in \mathcal{H}\), such that \(\mathfrak{h} \subset \mathfrak{k}\). 
  \begin{enumerate}
  \item If \(\mathfrak{k} \in \mathfrak{H}'\), then \(\mathfrak{k} \in \alpha' \subset \alpha\) and we are done.
  \item If \(\mathfrak{k} \in W \subset \alpha\) everything is fine, too. 
  \item So the only interesting case is to show that \(\mathfrak{k} \in W^\ast\) cannot happen. If this were the case, then we would have \(\mathfrak{k}^\ast \in W\) and \(\mathfrak{k}^\ast \subset \mathfrak{h}^\ast\). By the consistency of \(W\) we would have \(\mathfrak{h}^\ast \in W\). However, \(\mathfrak{h} \in \alpha = \alpha' \sqcup W\). This is a contradiction to the partial choice of \(W\). Hence \(\mathfrak{k} \notin W^\ast\).
  \end{enumerate}

  If \(\alpha' \neq \beta'\) in \(\mathcal{H}'\) then also \(\alpha \neq \beta\) in \(\mathcal{H}\) and \(i\) is injective. Next, let us consider the continuity of \(i\). Consider two finite subsets \(F_1, F_2 \subset \mathcal{H}\). These can be decomposed into \(F_i = G_i \sqcup E_i\), where \(G_i \subset \mathfrak{H}'\) and \(E_i \subset W \sqcup W^\ast\). Then we have
  \[
    i^{-1}(C(F_1, F_2)) = C(G_1, G_2)
  \]
  and \(i\) is continuous.

  In order to compute the image let us first show that \(i(\bar X') \subset \cap_{\mathfrak{h} \in W} \mathcal{C}(\mathfrak{h})\). Indeed, we have
  \[
    \alpha' \cap W = \bigcap_{\mathfrak{h} \in \alpha \sqcap W}\mathcal{C}(\mathfrak{h}) \subset \bigcap_{\mathfrak{h} \in W} \mathcal{C}(\mathfrak{h}).
  \]
  Conversely, if \(\alpha \in \cap_{\mathfrak{h} \in W}\mathcal{C}(\mathfrak{h})\), then \(W \subset \alpha\). Additionally, \((\alpha \setminus W) \cap W^\ast = \varnothing\) because of the choice condition. Hence \(\alpha' \coloneqq \alpha \setminus W \subset \mathcal{H}'\). We claim that \(\alpha'\) is an ultrafilter. The choice condition is satisfied, since it is satisfied by \(\alpha\). So let \(\mathfrak{h} \in \alpha'\) and \(\mathfrak{k} \in \mathcal{H}'\) such that \(\mathfrak{h} \subset \mathfrak{k}\). Hence \(\mathfrak{k} \in \alpha\) and \(\mathfrak{k} \notin W\). This shows that \(\mathfrak{k} \in \alpha'\) and \(\alpha'\) also satisfies the consistency condition.

  Since we are only interested in connected cube complexes, \(\mathcal{H}' = \varnothing\) implies that \(X'\) is only a single point. The same is true for \(\bar X'\) and its image under \(i\).

  If \(W\) contains an infinite descending chain, so does \(\alpha' \sqcup W\) and thus \(\alpha' \sqcup W \in \partial X\).
\end{proof}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../Master"
%%% End:
